# VideoPlanet MVP ê°œë°œ ì•¡ì…˜í”Œëœ v1.0.0

> ë³¸ ë¬¸ì„œëŠ” VideoPlanet í”„ë¡œì íŠ¸ì˜ MVP ê°œë°œì„ ìœ„í•œ ìƒì„¸ ì‹¤í–‰ ê³„íšì…ë‹ˆë‹¤.
> CLAUDE.mdì˜ ê°œë°œ í‘œì¤€ê³¼ Vlanet.mdì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì„ í†µí•©í•œ ì‹¤ë¬´ ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸ“Œ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [ê¸°ìˆ  ì•„í‚¤í…ì²˜](#2-ê¸°ìˆ -ì•„í‚¤í…ì²˜)
3. [Phase 0: í”„ë¡œì íŠ¸ ì´ˆê¸°í™”](#phase-0-í”„ë¡œì íŠ¸-ì´ˆê¸°í™”)
4. [Phase 1: í•µì‹¬ ì¸í”„ë¼](#phase-1-í•µì‹¬-ì¸í”„ë¼)
5. [Phase 2: ì‚¬ìš©ì ì‹œìŠ¤í…œ](#phase-2-ì‚¬ìš©ì-ì‹œìŠ¤í…œ)
6. [Phase 3: ì½˜í…ì¸  ê´€ë¦¬](#phase-3-ì½˜í…ì¸ -ê´€ë¦¬)
7. [Phase 4: ìƒí˜¸ì‘ìš© ê¸°ëŠ¥](#phase-4-ìƒí˜¸ì‘ìš©-ê¸°ëŠ¥)
8. [Phase 5: í€ë”© ì‹œìŠ¤í…œ](#phase-5-í€ë”©-ì‹œìŠ¤í…œ)
9. [Phase 6: í’ˆì§ˆ ë³´ì¦](#phase-6-í’ˆì§ˆ-ë³´ì¦)
10. [Phase 7: ë°°í¬ ë° ìš´ì˜](#phase-7-ë°°í¬-ë°-ìš´ì˜)
11. [ìœ„í—˜ ê´€ë¦¬](#ìœ„í—˜-ê´€ë¦¬)
12. [ì²´í¬ë¦¬ìŠ¤íŠ¸](#ì²´í¬ë¦¬ìŠ¤íŠ¸)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ë¹„ì „ ë° ëª©í‘œ
- **ë¹„ì „**: "Prompt to Profit" - AI ì°½ì‘ìì˜ ì•„ì´ë””ì–´ë¥¼ ìƒì—…ì  ì„±ê³µìœ¼ë¡œ
- **MVP ëª©í‘œ**:
  - ì°½ì‘ìì˜ AI ì˜ìƒ í¬íŠ¸í´ë¦¬ì˜¤ ì—…ë¡œë“œ/ê´€ë¦¬
  - íˆ¬ììì˜ ì½˜í…ì¸  íƒìƒ‰ ë° ì°½ì‘ì ë°œê²¬
  - í•µì‹¬ ì‚¬ì´í´(ì—…ë¡œë“œ â†’ ë°œê²¬ â†’ ì œì•ˆ) ê²€ì¦

### 1.2 í•µì‹¬ ì‚¬ìš©ì
1. **AI ì˜ìƒ ì°½ì‘ì (Creator)**
   - AI íˆ´ë¡œ ì˜ìƒì„ ì œì‘í•˜ëŠ” ê°œì¸/íŒ€
   - ìƒì—…í™” ê¸°íšŒë¥¼ ì°¾ëŠ” í¬ë¦¬ì—ì´í„°

2. **ì½˜í…ì¸  íˆ¬ìì (Funder)**
   - ì œì‘ì‚¬, ê´‘ê³  ì—ì´ì „ì‹œ ë‹´ë‹¹ì
   - ì‹ ì„ í•œ IPì™€ ì°½ì‘ìë¥¼ ì°¾ëŠ” ê¸°ì—…

### 1.3 MVP ë²”ìœ„ ì •ì˜
- **í¬í•¨ (In Scope)**:
  - ì†Œì…œ ë¡œê·¸ì¸ (Google OAuth)
  - ì—­í•  ê¸°ë°˜ í”„ë¡œí•„ ì‹œìŠ¤í…œ
  - ì˜ìƒ ì—…ë¡œë“œ ë° ê´€ë¦¬ (ì œí•œì )
  - ë©”ì¸ í”¼ë“œ ë° íƒìƒ‰
  - ê°„ì†Œí™”ëœ ì—°ë½ ì‹œìŠ¤í…œ

- **ì œì™¸ (Out of Scope)**:
  - ì‹¤ì‹œê°„ ì±„íŒ…
  - ê²°ì œ ì‹œìŠ¤í…œ
  - AI ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜
  - ê³ ê¸‰ ë¶„ì„ ë„êµ¬

---

## 2. ê¸°ìˆ  ì•„í‚¤í…ì²˜

### 2.1 ê¸°ìˆ  ìŠ¤íƒ
```
Frontend:
â”œâ”€â”€ Next.js 15.x (App Router)
â”œâ”€â”€ TypeScript 5.5.x
â”œâ”€â”€ Tailwind CSS v3.x
â”œâ”€â”€ Shadcn/UI Components
â””â”€â”€ Video.js / Plyr (Video Player)

Backend:
â”œâ”€â”€ Supabase (BaaS)
â”‚   â”œâ”€â”€ PostgreSQL (Database)
â”‚   â”œâ”€â”€ Auth (Authentication)
â”‚   â””â”€â”€ Storage (File Storage)
â””â”€â”€ Server Actions (Data Mutations)

Deployment:
â”œâ”€â”€ Vercel (Hosting)
â”œâ”€â”€ GitHub Actions (CI/CD)
â””â”€â”€ Sentry (Error Tracking)
```

### 2.2 FSD ì•„í‚¤í…ì²˜ êµ¬ì¡°
```
src/
â”œâ”€â”€ app/                 # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/         # ì¸ì¦ ê´€ë ¨ ë¼ìš°íŠ¸
â”‚   â”œâ”€â”€ (main)/         # ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ api/            # API ë¼ìš°íŠ¸
â”‚   â””â”€â”€ layout.tsx      # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚
â”œâ”€â”€ pages/              # FSD í˜ì´ì§€ ë ˆì´ì–´
â”‚   â”œâ”€â”€ home/          # í™ˆ í˜ì´ì§€
â”‚   â”œâ”€â”€ project/       # í”„ë¡œì íŠ¸ ìƒì„¸
â”‚   â”œâ”€â”€ upload/        # ì—…ë¡œë“œ í˜ì´ì§€
â”‚   â””â”€â”€ dashboard/     # ëŒ€ì‹œë³´ë“œ
â”‚
â”œâ”€â”€ widgets/            # ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ë¸”ë¡
â”‚   â”œâ”€â”€ header/        # í—¤ë”
â”‚   â”œâ”€â”€ footer/        # í‘¸í„°
â”‚   â”œâ”€â”€ project-card/  # í”„ë¡œì íŠ¸ ì¹´ë“œ
â”‚   â””â”€â”€ video-player/  # ë¹„ë””ì˜¤ í”Œë ˆì´ì–´
â”‚
â”œâ”€â”€ features/           # ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥
â”‚   â”œâ”€â”€ auth/          # ì¸ì¦ ê¸°ëŠ¥
â”‚   â”œâ”€â”€ upload/        # ì—…ë¡œë“œ ê¸°ëŠ¥
â”‚   â”œâ”€â”€ like/          # ì¢‹ì•„ìš” ê¸°ëŠ¥
â”‚   â””â”€â”€ proposal/      # ì œì•ˆ ê¸°ëŠ¥
â”‚
â”œâ”€â”€ entities/           # ë„ë©”ì¸ ì—”í‹°í‹°
â”‚   â”œâ”€â”€ user/          # ì‚¬ìš©ì
â”‚   â”œâ”€â”€ project/       # í”„ë¡œì íŠ¸
â”‚   â”œâ”€â”€ proposal/      # ì œì•ˆ
â”‚   â””â”€â”€ comment/       # ëŒ“ê¸€
â”‚
â””â”€â”€ shared/            # ê³µí†µ ë¦¬ì†ŒìŠ¤
    â”œâ”€â”€ api/           # API í´ë¼ì´ì–¸íŠ¸
    â”œâ”€â”€ config/        # ì„¤ì •
    â”œâ”€â”€ lib/           # ìœ í‹¸ë¦¬í‹°
    â””â”€â”€ ui/            # ê¸°ë³¸ UI ì»´í¬ë„ŒíŠ¸
```

### 2.3 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

#### 2.3.1 ì‚¬ìš©ì ê´€ë ¨
```sql
-- ì‚¬ìš©ì ì—­í•  Enum
CREATE TYPE user_role AS ENUM ('CREATOR', 'FUNDER', 'VIEWER');

-- í”„ë¡œí•„ í…Œì´ë¸”
CREATE TABLE profiles (
    id uuid REFERENCES auth.users PRIMARY KEY,
    username text UNIQUE,
    avatar_url text,
    bio text,
    role user_role DEFAULT 'VIEWER',
    company text, -- Funderì¸ ê²½ìš°
    website text,
    social_links jsonb, -- {twitter, instagram, etc}
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now()
);
```

#### 2.3.2 ì½˜í…ì¸  ê´€ë ¨
```sql
-- í”„ë¡œì íŠ¸ í…Œì´ë¸”
CREATE TABLE projects (
    id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
    creator_id uuid REFERENCES profiles(id) ON DELETE CASCADE,
    title text NOT NULL,
    description text,
    video_url text NOT NULL,
    thumbnail_url text NOT NULL,
    duration integer, -- ì´ˆ ë‹¨ìœ„
    file_size bigint, -- ë°”ì´íŠ¸ ë‹¨ìœ„

    -- ë©”íƒ€ë°ì´í„° (AI ì¤€ë¹„)
    genre text[],
    style text[],
    ai_tools text[],
    tags text[],

    -- í†µê³„
    views_count bigint DEFAULT 0,
    likes_count bigint DEFAULT 0,
    comments_count bigint DEFAULT 0,

    -- ê´€ë¦¬
    is_featured boolean DEFAULT false,
    is_public boolean DEFAULT true,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now()
);
```

#### 2.3.3 ìƒí˜¸ì‘ìš© ê´€ë ¨
```sql
-- ì¢‹ì•„ìš” í…Œì´ë¸”
CREATE TABLE likes (
    user_id uuid REFERENCES profiles(id) ON DELETE CASCADE,
    project_id uuid REFERENCES projects(id) ON DELETE CASCADE,
    created_at timestamptz DEFAULT now(),
    PRIMARY KEY (user_id, project_id)
);

-- ëŒ“ê¸€ í…Œì´ë¸”
CREATE TABLE comments (
    id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
    user_id uuid REFERENCES profiles(id) ON DELETE CASCADE,
    project_id uuid REFERENCES projects(id) ON DELETE CASCADE,
    content text NOT NULL,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now()
);

-- ì œì•ˆ ìƒíƒœ Enum
CREATE TYPE proposal_status AS ENUM ('PENDING', 'ACCEPTED', 'REJECTED');

-- ì œì•ˆ í…Œì´ë¸”
CREATE TABLE proposals (
    id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
    funder_id uuid REFERENCES profiles(id) ON DELETE CASCADE,
    creator_id uuid REFERENCES profiles(id) ON DELETE CASCADE,
    project_id uuid REFERENCES projects(id) ON DELETE SET NULL,

    -- ì œì•ˆ ë‚´ìš©
    subject text NOT NULL,
    message text NOT NULL,
    budget_range text,
    timeline text,

    -- ìƒíƒœ ê´€ë¦¬
    status proposal_status DEFAULT 'PENDING',
    responded_at timestamptz,

    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now()
);
```

---

## Phase 0: í”„ë¡œì íŠ¸ ì´ˆê¸°í™”

### ëª©í‘œ
- ê°œë°œ í™˜ê²½ êµ¬ì„± ë° í”„ë¡œì íŠ¸ ê¸°ë°˜ ì„¤ì •
- ì˜ˆìƒ ì†Œìš” ì‹œê°„: 1-2ì¼

### 0.1 Next.js í”„ë¡œì íŠ¸ ìƒì„±

```bash
# í”„ë¡œì íŠ¸ ìƒì„±
pnpm create next-app@latest videoplanet \
  --typescript \
  --tailwind \
  --app \
  --src-dir \
  --import-alias "@/*"

cd videoplanet

# ì¶”ê°€ íŒ¨í‚¤ì§€ ì„¤ì¹˜
pnpm add @supabase/supabase-js @supabase/ssr
pnpm add zod react-hook-form @hookform/resolvers
pnpm add clsx tailwind-merge class-variance-authority
pnpm add video.js @types/video.js
pnpm add -D @testing-library/react @testing-library/jest-dom jest-environment-jsdom
```

### 0.2 í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ì •

```bash
# FSD ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p src/{pages,widgets,features,entities,shared}
mkdir -p src/shared/{api,config,lib,ui}
mkdir -p src/entities/{user,project,proposal,comment}
mkdir -p src/features/{auth,upload,like,proposal}
mkdir -p src/widgets/{header,footer,project-card,video-player}
mkdir -p src/pages/{home,project,upload,dashboard}
```

### 0.3 í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env.local` íŒŒì¼ ìƒì„±:
```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# App
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Storage Limits
NEXT_PUBLIC_MAX_VIDEO_SIZE=209715200 # 200MB in bytes
NEXT_PUBLIC_MAX_VIDEO_DURATION=120 # 2 minutes in seconds
NEXT_PUBLIC_MAX_VIDEO_RESOLUTION=1080
```

### 0.4 í™˜ê²½ ë³€ìˆ˜ ê²€ì¦ ì„¤ì •

`src/shared/config/env.ts`:
```typescript
import { z } from 'zod';

const envSchema = z.object({
  NEXT_PUBLIC_SUPABASE_URL: z.string().url(),
  NEXT_PUBLIC_SUPABASE_ANON_KEY: z.string().min(1),
  SUPABASE_SERVICE_ROLE_KEY: z.string().min(1).optional(),
  NEXT_PUBLIC_APP_URL: z.string().url(),
  NEXT_PUBLIC_MAX_VIDEO_SIZE: z.string().transform(Number),
  NEXT_PUBLIC_MAX_VIDEO_DURATION: z.string().transform(Number),
  NEXT_PUBLIC_MAX_VIDEO_RESOLUTION: z.string().transform(Number),
});

export const env = envSchema.parse(process.env);
```

### 0.5 Supabase í´ë¼ì´ì–¸íŠ¸ ì„¤ì •

`src/shared/api/supabase/client.ts`:
```typescript
import { createBrowserClient } from '@supabase/ssr';
import { env } from '@/shared/config/env';

export function createClient() {
  return createBrowserClient(
    env.NEXT_PUBLIC_SUPABASE_URL,
    env.NEXT_PUBLIC_SUPABASE_ANON_KEY
  );
}
```

`src/shared/api/supabase/server.ts`:
```typescript
import { createServerClient } from '@supabase/ssr';
import { cookies } from 'next/headers';

export async function createClient() {
  const cookieStore = await cookies();

  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll();
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value, options }) =>
            cookieStore.set(name, value, options)
          );
        },
      },
    }
  );
}
```

### 0.6 ESLint ë° Prettier ì„¤ì •

`.eslintrc.json`:
```json
{
  "extends": [
    "next/core-web-vitals",
    "next/typescript"
  ],
  "rules": {
    "no-restricted-imports": [
      "error",
      {
        "patterns": [
          {
            "group": ["@/features/*/*"],
            "message": "Use public API (index.ts) imports only"
          }
        ]
      }
    ],
    "@typescript-eslint/no-explicit-any": "error",
    "@typescript-eslint/no-unused-vars": ["error", { "argsIgnorePattern": "^_" }]
  }
}
```

`.prettierrc.json`:
```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 100,
  "plugins": ["prettier-plugin-tailwindcss"]
}
```

### 0.7 Tailwind ì„¤ì •

`tailwind.config.ts`:
```typescript
import type { Config } from 'tailwindcss';

const config: Config = {
  content: ['./src/**/*.{js,ts,jsx,tsx,mdx}'],
  theme: {
    extend: {
      colors: {
        // VLANET ë¸Œëœë“œ ìƒ‰ìƒ (ë¡œê³  ê¸°ë°˜)
        primary: {
          50: '#eff6ff',
          100: '#dbeafe',
          200: '#bfdbfe',
          300: '#93c5fd',
          400: '#60a5fa',
          500: '#0059db', // ë¡œê³  ë°ì€ ë¸”ë£¨
          600: '#004ac1', // ë¡œê³  ì§„í•œ ë¸”ë£¨
          700: '#003a9b',
          800: '#1e3a8a',
          900: '#1e2b4f',
        },
        secondary: {
          50: '#f8fafc',
          100: '#f1f5f9',
          200: '#e2e8f0',
          300: '#cbd5e1',
          400: '#94a3b8',
          500: '#64748b',
          600: '#475569',
          700: '#334155',
          800: '#1e293b',
          900: '#0f172a',
        },
        danger: {
          50: '#fef2f2',
          500: '#ef4444',
          900: '#7f1d1d',
        },
        success: {
          50: '#f0fdf4',
          500: '#22c55e',
          900: '#14532d',
        },
      },
      animation: {
        'fade-in': 'fadeIn 0.5s ease-in-out',
        'slide-up': 'slideUp 0.3s ease-out',
      },
    },
  },
  plugins: [],
};

export default config;
```

---

## Phase 1: í•µì‹¬ ì¸í”„ë¼

### ëª©í‘œ
- ì¸ì¦ ì‹œìŠ¤í…œ êµ¬ì¶•
- ê¸°ë³¸ ë¼ìš°íŒ… ì„¤ì •
- ë¹„ë””ì˜¤ ì¸í”„ë¼ êµ¬ì¶•
- ì˜ˆìƒ ì†Œìš” ì‹œê°„: 3-5ì¼

### 1.1 ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„

#### 1.1.1 OAuth ì½œë°± í•¸ë“¤ëŸ¬
`src/app/auth/callback/route.ts`:
```typescript
import { createClient } from '@/shared/api/supabase/server';
import { NextResponse } from 'next/server';

export async function GET(request: Request) {
  const requestUrl = new URL(request.url);
  const code = requestUrl.searchParams.get('code');
  const origin = requestUrl.origin;

  if (code) {
    const supabase = await createClient();
    await supabase.auth.exchangeCodeForSession(code);
  }

  return NextResponse.redirect(`${origin}/onboarding`);
}
```

#### 1.1.2 ë¡œê·¸ì¸ í˜ì´ì§€
`src/pages/auth/login/index.tsx`:
```typescript
'use client';

import { createClient } from '@/shared/api/supabase/client';
import { Button } from '@/shared/ui/button';

export function LoginPage() {
  const supabase = createClient();

  const handleGoogleLogin = async () => {
    await supabase.auth.signInWithOAuth({
      provider: 'google',
      options: {
        redirectTo: `${window.location.origin}/auth/callback`,
      },
    });
  };

  return (
    <div className="flex min-h-screen items-center justify-center">
      <div className="w-full max-w-md space-y-8 rounded-lg bg-white p-8 shadow-lg">
        <div className="text-center">
          <h1 className="text-3xl font-bold">VideoPlanet</h1>
          <p className="mt-2 text-gray-600">AI ì°½ì‘ìì™€ íˆ¬ììë¥¼ ì—°ê²°í•©ë‹ˆë‹¤</p>
        </div>

        <Button
          onClick={handleGoogleLogin}
          className="w-full"
          variant="primary"
        >
          Googleë¡œ ì‹œì‘í•˜ê¸°
        </Button>
      </div>
    </div>
  );
}
```

#### 1.1.3 ë¯¸ë“¤ì›¨ì–´ ì„¤ì •
`src/middleware.ts`:
```typescript
import { createServerClient } from '@supabase/ssr';
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export async function middleware(request: NextRequest) {
  const response = NextResponse.next();

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return request.cookies.getAll();
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value }) =>
            request.cookies.set(name, value)
          );
          cookiesToSet.forEach(({ name, value, options }) =>
            response.cookies.set(name, value, options)
          );
        },
      },
    }
  );

  const { data: { user } } = await supabase.auth.getUser();

  // ë³´í˜¸ëœ ë¼ìš°íŠ¸ ì²´í¬
  const protectedRoutes = ['/upload', '/dashboard', '/profile'];
  const isProtectedRoute = protectedRoutes.some(route =>
    request.nextUrl.pathname.startsWith(route)
  );

  if (isProtectedRoute && !user) {
    return NextResponse.redirect(new URL('/login', request.url));
  }

  // ì˜¨ë³´ë”© ì²´í¬
  if (user && !request.nextUrl.pathname.startsWith('/onboarding')) {
    const { data: profile } = await supabase
      .from('profiles')
      .select('username, role')
      .eq('id', user.id)
      .single();

    if (!profile?.username || !profile?.role) {
      return NextResponse.redirect(new URL('/onboarding', request.url));
    }
  }

  return response;
}

export const config = {
  matcher: [
    '/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',
  ],
};
```

### 1.2 ë¹„ë””ì˜¤ ì¸í”„ë¼ êµ¬ì¶•

#### 1.2.1 ë¹„ë””ì˜¤ ì—…ë¡œë“œ ìœ íš¨ì„± ê²€ì‚¬
`src/features/upload/lib/validation.ts`:
```typescript
import { z } from 'zod';
import { env } from '@/shared/config/env';

export const videoFileSchema = z.object({
  file: z
    .instanceof(File)
    .refine((file) => file.type === 'video/mp4', {
      message: 'MP4 í˜•ì‹ë§Œ ì§€ì›ë©ë‹ˆë‹¤',
    })
    .refine((file) => file.size <= env.NEXT_PUBLIC_MAX_VIDEO_SIZE, {
      message: 'íŒŒì¼ í¬ê¸°ëŠ” 200MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤',
    }),
});

export const projectUploadSchema = z.object({
  title: z.string().min(1, 'ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”').max(100),
  description: z.string().min(10, 'ìµœì†Œ 10ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”').max(1000),
  genre: z.array(z.string()).min(1, 'ìµœì†Œ 1ê°œ ì´ìƒì˜ ì¥ë¥´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”'),
  style: z.array(z.string()).min(1, 'ìµœì†Œ 1ê°œ ì´ìƒì˜ ìŠ¤íƒ€ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”'),
  aiTools: z.array(z.string()).min(1, 'ì‚¬ìš©í•œ AI íˆ´ì„ ì„ íƒí•´ì£¼ì„¸ìš”'),
});

// ë¹„ë””ì˜¤ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ í•¨ìˆ˜
export async function extractVideoMetadata(file: File): Promise<{
  duration: number;
  width: number;
  height: number;
}> {
  return new Promise((resolve, reject) => {
    const video = document.createElement('video');
    video.preload = 'metadata';

    video.onloadedmetadata = () => {
      resolve({
        duration: video.duration,
        width: video.videoWidth,
        height: video.videoHeight,
      });
      URL.revokeObjectURL(video.src);
    };

    video.onerror = reject;
    video.src = URL.createObjectURL(file);
  });
}
```

#### 1.2.2 í‘œì¤€ ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ ì»´í¬ë„ŒíŠ¸
`src/shared/ui/video-player/index.tsx`:
```typescript
'use client';

import { useEffect, useRef } from 'react';
import videojs from 'video.js';
import Player from 'video.js/dist/types/player';
import 'video.js/dist/video-js.css';

interface VideoPlayerProps {
  src: string;
  poster?: string;
  className?: string;
  onReady?: (player: Player) => void;
}

export function VideoPlayer({ src, poster, className, onReady }: VideoPlayerProps) {
  const videoRef = useRef<HTMLDivElement>(null);
  const playerRef = useRef<Player | null>(null);

  useEffect(() => {
    if (!playerRef.current && videoRef.current) {
      const videoElement = document.createElement('video-js');
      videoElement.classList.add('vjs-big-play-centered');
      videoRef.current.appendChild(videoElement);

      const player = (playerRef.current = videojs(videoElement, {
        autoplay: false,
        controls: true,
        responsive: true,
        fluid: true,
        sources: [{ src, type: 'video/mp4' }],
        poster,
        playbackRates: [0.5, 1, 1.5, 2],
        controlBar: {
          volumePanel: {
            inline: false,
          },
        },
      }, () => {
        onReady?.(player);
      }));
    }

    return () => {
      if (playerRef.current) {
        playerRef.current.dispose();
        playerRef.current = null;
      }
    };
  }, [src, poster, onReady]);

  return (
    <div data-vjs-player className={className}>
      <div ref={videoRef} />
    </div>
  );
}
```

### 1.3 Server Actions ê¸°ë³¸ ì„¤ì •

`src/shared/lib/server-action.ts`:
```typescript
import { createClient } from '@/shared/api/supabase/server';

export type ActionResult<T = void> =
  | { success: true; data: T }
  | { success: false; error: string };

export async function authenticatedAction<T, R>(
  action: (userId: string, data: T) => Promise<ActionResult<R>>
) {
  return async (data: T): Promise<ActionResult<R>> => {
    const supabase = await createClient();
    const { data: { user } } = await supabase.auth.getUser();

    if (!user) {
      return { success: false, error: 'ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤' };
    }

    try {
      return await action(user.id, data);
    } catch (error) {
      console.error('Server action error:', error);
      return { success: false, error: 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' };
    }
  };
}
```

---

## Phase 2: ì‚¬ìš©ì ì‹œìŠ¤í…œ

### ëª©í‘œ
- ì˜¨ë³´ë”© í”Œë¡œìš° êµ¬í˜„
- ì—­í•  ê¸°ë°˜ í”„ë¡œí•„ ì‹œìŠ¤í…œ
- ì˜ˆìƒ ì†Œìš” ì‹œê°„: 3ì¼

### 2.1 ì˜¨ë³´ë”© êµ¬í˜„

`src/pages/onboarding/index.tsx`:
```typescript
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { createClient } from '@/shared/api/supabase/client';
import { UserRole } from '@/entities/user/types';
import { Button } from '@/shared/ui/button';
import { Input } from '@/shared/ui/input';
import { Textarea } from '@/shared/ui/textarea';

export function OnboardingPage() {
  const router = useRouter();
  const [step, setStep] = useState(1);
  const [formData, setFormData] = useState({
    role: '' as UserRole,
    username: '',
    bio: '',
    company: '',
  });

  const handleRoleSelect = (role: UserRole) => {
    setFormData({ ...formData, role });
    setStep(2);
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    const supabase = createClient();
    const { data: { user } } = await supabase.auth.getUser();

    if (!user) return;

    const { error } = await supabase
      .from('profiles')
      .upsert({
        id: user.id,
        ...formData,
        updated_at: new Date().toISOString(),
      });

    if (!error) {
      router.push('/');
    }
  };

  if (step === 1) {
    return (
      <div className="flex min-h-screen items-center justify-center">
        <div className="w-full max-w-2xl space-y-8 p-8">
          <h1 className="text-center text-3xl font-bold">
            ì–´ë–¤ ëª©ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì‹œë‚˜ìš”?
          </h1>

          <div className="grid gap-4 md:grid-cols-2">
            <button
              onClick={() => handleRoleSelect('CREATOR')}
              className="group rounded-lg border-2 border-gray-200 p-8 transition hover:border-primary-500"
            >
              <h2 className="text-xl font-semibold">ì°½ì‘ì</h2>
              <p className="mt-2 text-gray-600">
                AIë¡œ ë§Œë“  ì˜ìƒì„ ê³µìœ í•˜ê³  íˆ¬ì ê¸°íšŒë¥¼ ì°¾ìŠµë‹ˆë‹¤
              </p>
            </button>

            <button
              onClick={() => handleRoleSelect('FUNDER')}
              className="group rounded-lg border-2 border-gray-200 p-8 transition hover:border-primary-500"
            >
              <h2 className="text-xl font-semibold">íˆ¬ìì</h2>
              <p className="mt-2 text-gray-600">
                ì¬ëŠ¥ ìˆëŠ” ì°½ì‘ìë¥¼ ë°œêµ´í•˜ê³  í˜‘ì—… ê¸°íšŒë¥¼ ì œì•ˆí•©ë‹ˆë‹¤
              </p>
            </button>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="flex min-h-screen items-center justify-center">
      <form onSubmit={handleSubmit} className="w-full max-w-md space-y-6 p-8">
        <h1 className="text-2xl font-bold">í”„ë¡œí•„ ì„¤ì •</h1>

        <div>
          <label htmlFor="username" className="block text-sm font-medium">
            ì‚¬ìš©ìëª…
          </label>
          <Input
            id="username"
            value={formData.username}
            onChange={(e) => setFormData({ ...formData, username: e.target.value })}
            required
            placeholder="@username"
          />
        </div>

        <div>
          <label htmlFor="bio" className="block text-sm font-medium">
            ì†Œê°œ
          </label>
          <Textarea
            id="bio"
            value={formData.bio}
            onChange={(e) => setFormData({ ...formData, bio: e.target.value })}
            rows={3}
            placeholder="ê°„ë‹¨í•œ ì†Œê°œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”"
          />
        </div>

        {formData.role === 'FUNDER' && (
          <div>
            <label htmlFor="company" className="block text-sm font-medium">
              ì†Œì†
            </label>
            <Input
              id="company"
              value={formData.company}
              onChange={(e) => setFormData({ ...formData, company: e.target.value })}
              placeholder="íšŒì‚¬ëª…"
            />
          </div>
        )}

        <Button type="submit" className="w-full">
          ì‹œì‘í•˜ê¸°
        </Button>
      </form>
    </div>
  );
}
```

### 2.2 í”„ë¡œí•„ ì—”í‹°í‹° ì •ì˜

`src/entities/user/types.ts`:
```typescript
export type UserRole = 'CREATOR' | 'FUNDER' | 'VIEWER';

export interface Profile {
  id: string;
  username: string;
  avatarUrl?: string;
  bio?: string;
  role: UserRole;
  company?: string;
  website?: string;
  socialLinks?: {
    twitter?: string;
    instagram?: string;
    youtube?: string;
  };
  createdAt: string;
  updatedAt: string;
}
```

`src/entities/user/api.ts`:
```typescript
import { createClient } from '@/shared/api/supabase/server';
import type { Profile } from './types';

export async function getCurrentProfile(): Promise<Profile | null> {
  const supabase = await createClient();
  const { data: { user } } = await supabase.auth.getUser();

  if (!user) return null;

  const { data } = await supabase
    .from('profiles')
    .select('*')
    .eq('id', user.id)
    .single();

  return data;
}

export async function getProfileById(id: string): Promise<Profile | null> {
  const supabase = await createClient();

  const { data } = await supabase
    .from('profiles')
    .select('*')
    .eq('id', id)
    .single();

  return data;
}
```

---

## Phase 3: ì½˜í…ì¸  ê´€ë¦¬

### ëª©í‘œ
- í”„ë¡œì íŠ¸ ì—…ë¡œë“œ ì‹œìŠ¤í…œ
- ë©”ì¸ í”¼ë“œ êµ¬í˜„
- í”„ë¡œì íŠ¸ ìƒì„¸ í˜ì´ì§€
- ì˜ˆìƒ ì†Œìš” ì‹œê°„: 4ì¼

### 3.1 ì—…ë¡œë“œ í˜ì´ì§€

`src/pages/upload/index.tsx`:
```typescript
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { uploadProject } from '@/features/upload/actions';
import { projectUploadSchema, extractVideoMetadata } from '@/features/upload/lib/validation';
import { Button } from '@/shared/ui/button';
import { Input } from '@/shared/ui/input';
import { Textarea } from '@/shared/ui/textarea';
import { Select } from '@/shared/ui/select';
import { FileUpload } from '@/features/upload/components/file-upload';

const GENRES = ['SF', 'íŒíƒ€ì§€', 'ë“œë¼ë§ˆ', 'ì•¡ì…˜', 'ì½”ë¯¸ë””', 'í˜¸ëŸ¬', 'ë‹¤íë©˜í„°ë¦¬'];
const STYLES = ['ì• ë‹ˆë©”ì´ì…˜', 'ì‹¤ì‚¬', 'í•˜ì´í¼ë¦¬ì–¼ë¦¬ì¦˜', '2D', '3D', 'ë¯¹ìŠ¤'];
const AI_TOOLS = ['RunwayML', 'Pika', 'Stable Diffusion', 'Midjourney', 'DALL-E'];

export function UploadPage() {
  const router = useRouter();
  const [videoFile, setVideoFile] = useState<File | null>(null);
  const [thumbnailFile, setThumbnailFile] = useState<File | null>(null);
  const [uploading, setUploading] = useState(false);

  const {
    register,
    handleSubmit,
    formState: { errors },
    setValue,
    watch,
  } = useForm({
    resolver: zodResolver(projectUploadSchema),
  });

  const onSubmit = async (data: any) => {
    if (!videoFile || !thumbnailFile) return;

    setUploading(true);

    try {
      // ë¹„ë””ì˜¤ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
      const metadata = await extractVideoMetadata(videoFile);

      // íŒŒì¼ ì—…ë¡œë“œ ë° í”„ë¡œì íŠ¸ ìƒì„±
      const result = await uploadProject({
        ...data,
        videoFile,
        thumbnailFile,
        duration: Math.floor(metadata.duration),
        fileSize: videoFile.size,
      });

      if (result.success) {
        router.push(`/projects/${result.data.id}`);
      }
    } catch (error) {
      console.error('Upload error:', error);
    } finally {
      setUploading(false);
    }
  };

  return (
    <div className="mx-auto max-w-4xl px-4 py-8">
      <h1 className="mb-8 text-3xl font-bold">í”„ë¡œì íŠ¸ ì—…ë¡œë“œ</h1>

      <form onSubmit={handleSubmit(onSubmit)} className="space-y-8">
        <div className="grid gap-8 lg:grid-cols-2">
          {/* ë¹„ë””ì˜¤ ì—…ë¡œë“œ */}
          <div>
            <label className="mb-2 block text-sm font-medium">
              ë¹„ë””ì˜¤ íŒŒì¼ (MP4, ìµœëŒ€ 200MB)
            </label>
            <FileUpload
              accept="video/mp4"
              maxSize={200 * 1024 * 1024}
              onFileSelect={setVideoFile}
              className="h-64"
            />
            {videoFile && (
              <p className="mt-2 text-sm text-gray-600">
                {videoFile.name} ({(videoFile.size / 1024 / 1024).toFixed(2)} MB)
              </p>
            )}
          </div>

          {/* ì¸ë„¤ì¼ ì—…ë¡œë“œ */}
          <div>
            <label className="mb-2 block text-sm font-medium">
              ì¸ë„¤ì¼ ì´ë¯¸ì§€
            </label>
            <FileUpload
              accept="image/*"
              maxSize={5 * 1024 * 1024}
              onFileSelect={setThumbnailFile}
              className="h-64"
              preview
            />
          </div>
        </div>

        {/* í”„ë¡œì íŠ¸ ì •ë³´ */}
        <div className="space-y-6">
          <div>
            <label htmlFor="title" className="mb-2 block text-sm font-medium">
              ì œëª©
            </label>
            <Input
              id="title"
              {...register('title')}
              placeholder="í”„ë¡œì íŠ¸ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
              error={errors.title?.message}
            />
          </div>

          <div>
            <label htmlFor="description" className="mb-2 block text-sm font-medium">
              ì„¤ëª…
            </label>
            <Textarea
              id="description"
              {...register('description')}
              rows={5}
              placeholder="í”„ë¡œì íŠ¸ì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”"
              error={errors.description?.message}
            />
          </div>

          <div className="grid gap-6 lg:grid-cols-3">
            <div>
              <label className="mb-2 block text-sm font-medium">ì¥ë¥´</label>
              <Select
                multiple
                options={GENRES.map(g => ({ value: g, label: g }))}
                onChange={(values) => setValue('genre', values)}
                error={errors.genre?.message}
              />
            </div>

            <div>
              <label className="mb-2 block text-sm font-medium">ìŠ¤íƒ€ì¼</label>
              <Select
                multiple
                options={STYLES.map(s => ({ value: s, label: s }))}
                onChange={(values) => setValue('style', values)}
                error={errors.style?.message}
              />
            </div>

            <div>
              <label className="mb-2 block text-sm font-medium">ì‚¬ìš© AI íˆ´</label>
              <Select
                multiple
                options={AI_TOOLS.map(t => ({ value: t, label: t }))}
                onChange={(values) => setValue('aiTools', values)}
                error={errors.aiTools?.message}
              />
            </div>
          </div>
        </div>

        <div className="flex justify-end gap-4">
          <Button
            type="button"
            variant="secondary"
            onClick={() => router.push('/')}
          >
            ì·¨ì†Œ
          </Button>
          <Button
            type="submit"
            disabled={uploading || !videoFile || !thumbnailFile}
          >
            {uploading ? 'ì—…ë¡œë“œ ì¤‘...' : 'ì—…ë¡œë“œ'}
          </Button>
        </div>
      </form>
    </div>
  );
}
```

### 3.2 ì—…ë¡œë“œ Server Action

`src/features/upload/actions.ts`:
```typescript
'use server';

import { createClient } from '@/shared/api/supabase/server';
import { authenticatedAction } from '@/shared/lib/server-action';
import { revalidatePath } from 'next/cache';
import { z } from 'zod';

const uploadSchema = z.object({
  title: z.string().min(1).max(100),
  description: z.string().min(10).max(1000),
  genre: z.array(z.string()),
  style: z.array(z.string()),
  aiTools: z.array(z.string()),
  videoUrl: z.string().url(),
  thumbnailUrl: z.string().url(),
  duration: z.number(),
  fileSize: z.number(),
});

export const uploadProject = authenticatedAction(async (userId, data) => {
  const validated = uploadSchema.parse(data);

  const supabase = await createClient();

  // í”„ë¡œì íŠ¸ ìƒì„±
  const { data: project, error } = await supabase
    .from('projects')
    .insert({
      creator_id: userId,
      title: validated.title,
      description: validated.description,
      video_url: validated.videoUrl,
      thumbnail_url: validated.thumbnailUrl,
      duration: validated.duration,
      file_size: validated.fileSize,
      genre: validated.genre,
      style: validated.style,
      ai_tools: validated.aiTools,
    })
    .select()
    .single();

  if (error) {
    return { success: false, error: 'í”„ë¡œì íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' };
  }

  revalidatePath('/');
  revalidatePath('/dashboard/projects');

  return { success: true, data: project };
});
```

### 3.3 ë©”ì¸ í”¼ë“œ êµ¬í˜„

`src/pages/home/index.tsx`:
```typescript
import { Suspense } from 'react';
import { createClient } from '@/shared/api/supabase/server';
import { ProjectCard } from '@/widgets/project-card';
import { ProjectFilters } from '@/features/project/components/filters';
import { Pagination } from '@/shared/ui/pagination';

interface HomePageProps {
  searchParams: {
    page?: string;
    sort?: 'latest' | 'popular';
    genre?: string;
    style?: string;
  };
}

export async function HomePage({ searchParams }: HomePageProps) {
  const page = Number(searchParams.page) || 1;
  const sort = searchParams.sort || 'latest';
  const limit = 12;
  const offset = (page - 1) * limit;

  const supabase = await createClient();

  // ì¿¼ë¦¬ ë¹Œë“œ
  let query = supabase
    .from('projects')
    .select(`
      *,
      creator:profiles!creator_id(username, avatar_url)
    `, { count: 'exact' })
    .eq('is_public', true)
    .range(offset, offset + limit - 1);

  // ì •ë ¬
  if (sort === 'latest') {
    query = query.order('created_at', { ascending: false });
  } else if (sort === 'popular') {
    query = query.order('likes_count', { ascending: false });
  }

  // í•„í„°
  if (searchParams.genre) {
    query = query.contains('genre', [searchParams.genre]);
  }
  if (searchParams.style) {
    query = query.contains('style', [searchParams.style]);
  }

  const { data: projects, count } = await query;
  const totalPages = Math.ceil((count || 0) / limit);

  return (
    <div className="container mx-auto px-4 py-8">
      {/* Featured Section */}
      <section className="mb-12">
        <h2 className="mb-6 text-2xl font-bold">VideoPlanet's Pick</h2>
        <Suspense fallback={<div>Loading featured...</div>}>
          <FeaturedProjects />
        </Suspense>
      </section>

      {/* í•„í„° */}
      <ProjectFilters />

      {/* í”„ë¡œì íŠ¸ ê·¸ë¦¬ë“œ */}
      <div className="mt-8 grid gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
        {projects?.map((project) => (
          <ProjectCard key={project.id} project={project} />
        ))}
      </div>

      {/* í˜ì´ì§€ë„¤ì´ì…˜ */}
      <Pagination
        currentPage={page}
        totalPages={totalPages}
        baseUrl="/"
      />
    </div>
  );
}

async function FeaturedProjects() {
  const supabase = await createClient();

  const { data: featured } = await supabase
    .from('projects')
    .select(`
      *,
      creator:profiles!creator_id(username, avatar_url)
    `)
    .eq('is_featured', true)
    .eq('is_public', true)
    .limit(4);

  return (
    <div className="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
      {featured?.map((project) => (
        <ProjectCard key={project.id} project={project} featured />
      ))}
    </div>
  );
}
```

---

## Phase 4: ìƒí˜¸ì‘ìš© ê¸°ëŠ¥

### ëª©í‘œ
- ì¢‹ì•„ìš” ì‹œìŠ¤í…œ
- ëŒ“ê¸€ ê¸°ëŠ¥
- ì˜ˆìƒ ì†Œìš” ì‹œê°„: 3ì¼

### 4.1 ì¢‹ì•„ìš” ê¸°ëŠ¥

`src/features/like/actions.ts`:
```typescript
'use server';

import { createClient } from '@/shared/api/supabase/server';
import { authenticatedAction } from '@/shared/lib/server-action';
import { revalidatePath } from 'next/cache';

export const toggleLike = authenticatedAction(async (userId, projectId: string) => {
  const supabase = await createClient();

  // ê¸°ì¡´ ì¢‹ì•„ìš” í™•ì¸
  const { data: existingLike } = await supabase
    .from('likes')
    .select()
    .eq('user_id', userId)
    .eq('project_id', projectId)
    .single();

  if (existingLike) {
    // ì¢‹ì•„ìš” ì·¨ì†Œ
    await supabase
      .from('likes')
      .delete()
      .eq('user_id', userId)
      .eq('project_id', projectId);
  } else {
    // ì¢‹ì•„ìš” ì¶”ê°€
    await supabase
      .from('likes')
      .insert({ user_id: userId, project_id: projectId });
  }

  revalidatePath(`/projects/${projectId}`);
  revalidatePath('/');

  return { success: true, data: { liked: !existingLike } };
});
```

`src/features/like/components/like-button.tsx`:
```typescript
'use client';

import { useState, useTransition } from 'react';
import { toggleLike } from '../actions';
import { Heart } from 'lucide-react';
import { cn } from '@/shared/lib/utils';

interface LikeButtonProps {
  projectId: string;
  initialLiked: boolean;
  initialCount: number;
  size?: 'sm' | 'md' | 'lg';
}

export function LikeButton({
  projectId,
  initialLiked,
  initialCount,
  size = 'md'
}: LikeButtonProps) {
  const [liked, setLiked] = useState(initialLiked);
  const [count, setCount] = useState(initialCount);
  const [isPending, startTransition] = useTransition();

  const handleLike = () => {
    // Optimistic update
    setLiked(!liked);
    setCount(liked ? count - 1 : count + 1);

    startTransition(async () => {
      const result = await toggleLike(projectId);
      if (!result.success) {
        // Revert on error
        setLiked(liked);
        setCount(count);
      }
    });
  };

  return (
    <button
      onClick={handleLike}
      disabled={isPending}
      className={cn(
        'flex items-center gap-2 rounded-full px-3 py-1.5 transition',
        'hover:bg-gray-100',
        liked && 'text-red-500'
      )}
    >
      <Heart
        className={cn(
          'transition',
          size === 'sm' && 'h-4 w-4',
          size === 'md' && 'h-5 w-5',
          size === 'lg' && 'h-6 w-6',
          liked && 'fill-current'
        )}
      />
      <span className="text-sm font-medium">{count}</span>
    </button>
  );
}
```

### 4.2 ëŒ“ê¸€ ì‹œìŠ¤í…œ

`src/features/comment/actions.ts`:
```typescript
'use server';

import { createClient } from '@/shared/api/supabase/server';
import { authenticatedAction } from '@/shared/lib/server-action';
import { revalidatePath } from 'next/cache';
import { z } from 'zod';

const commentSchema = z.object({
  projectId: z.string().uuid(),
  content: z.string().min(1).max(500),
});

export const addComment = authenticatedAction(async (userId, data) => {
  const validated = commentSchema.parse(data);

  const supabase = await createClient();

  const { data: comment, error } = await supabase
    .from('comments')
    .insert({
      user_id: userId,
      project_id: validated.projectId,
      content: validated.content,
    })
    .select(`
      *,
      user:profiles!user_id(username, avatar_url)
    `)
    .single();

  if (error) {
    return { success: false, error: 'ëŒ“ê¸€ ì‘ì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' };
  }

  revalidatePath(`/projects/${validated.projectId}`);

  return { success: true, data: comment };
});

export const deleteComment = authenticatedAction(async (userId, commentId: string) => {
  const supabase = await createClient();

  const { error } = await supabase
    .from('comments')
    .delete()
    .eq('id', commentId)
    .eq('user_id', userId);

  if (error) {
    return { success: false, error: 'ëŒ“ê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' };
  }

  revalidatePath('/');

  return { success: true, data: null };
});
```

---

## Phase 5: í€ë”© ì‹œìŠ¤í…œ

### ëª©í‘œ
- ê°„ì†Œí™”ëœ ì—°ë½ ì‹œìŠ¤í…œ
- ì œì•ˆ ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ
- ì˜ˆìƒ ì†Œìš” ì‹œê°„: 3ì¼

### 5.1 ì—°ë½í•˜ê¸° ê¸°ëŠ¥

`src/features/proposal/components/contact-modal.tsx`:
```typescript
'use client';

import { useState } from 'react';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';
import { sendProposal } from '../actions';
import { Dialog } from '@/shared/ui/dialog';
import { Button } from '@/shared/ui/button';
import { Input } from '@/shared/ui/input';
import { Textarea } from '@/shared/ui/textarea';

const proposalSchema = z.object({
  subject: z.string().min(1, 'ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'),
  message: z.string().min(10, 'ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'),
  budgetRange: z.string().optional(),
  timeline: z.string().optional(),
});

interface ContactModalProps {
  creatorId: string;
  projectId?: string;
  creatorName: string;
  open: boolean;
  onClose: () => void;
}

export function ContactModal({
  creatorId,
  projectId,
  creatorName,
  open,
  onClose,
}: ContactModalProps) {
  const [sending, setSending] = useState(false);

  const {
    register,
    handleSubmit,
    formState: { errors },
    reset,
  } = useForm({
    resolver: zodResolver(proposalSchema),
  });

  const onSubmit = async (data: any) => {
    setSending(true);

    const result = await sendProposal({
      ...data,
      creatorId,
      projectId,
    });

    if (result.success) {
      reset();
      onClose();
      // Show success toast
    }

    setSending(false);
  };

  return (
    <Dialog open={open} onClose={onClose}>
      <div className="p-6">
        <h2 className="mb-4 text-2xl font-bold">
          {creatorName}ë‹˜ì—ê²Œ ì œì•ˆí•˜ê¸°
        </h2>

        <form onSubmit={handleSubmit(onSubmit)} className="space-y-4">
          <div>
            <label htmlFor="subject" className="block text-sm font-medium">
              ì œëª©
            </label>
            <Input
              id="subject"
              {...register('subject')}
              placeholder="ì œì•ˆ ì œëª©"
              error={errors.subject?.message}
            />
          </div>

          <div>
            <label htmlFor="message" className="block text-sm font-medium">
              ë©”ì‹œì§€
            </label>
            <Textarea
              id="message"
              {...register('message')}
              rows={5}
              placeholder="ì œì•ˆ ë‚´ìš©ì„ ìì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš”"
              error={errors.message?.message}
            />
          </div>

          <div>
            <label htmlFor="budgetRange" className="block text-sm font-medium">
              ì˜ˆì‚° ë²”ìœ„ (ì„ íƒ)
            </label>
            <Input
              id="budgetRange"
              {...register('budgetRange')}
              placeholder="ì˜ˆ: 500-1000ë§Œì›"
            />
          </div>

          <div>
            <label htmlFor="timeline" className="block text-sm font-medium">
              ì¼ì • (ì„ íƒ)
            </label>
            <Input
              id="timeline"
              {...register('timeline')}
              placeholder="ì˜ˆ: 2024ë…„ 1ë¶„ê¸°"
            />
          </div>

          <div className="flex justify-end gap-3">
            <Button type="button" variant="secondary" onClick={onClose}>
              ì·¨ì†Œ
            </Button>
            <Button type="submit" disabled={sending}>
              {sending ? 'ì „ì†¡ ì¤‘...' : 'ì œì•ˆí•˜ê¸°'}
            </Button>
          </div>
        </form>
      </div>
    </Dialog>
  );
}
```

### 5.2 ì œì•ˆ ëŒ€ì‹œë³´ë“œ

`src/pages/dashboard/proposals/index.tsx`:
```typescript
import { createClient } from '@/shared/api/supabase/server';
import { getCurrentProfile } from '@/entities/user/api';
import { ProposalList } from '@/features/proposal/components/proposal-list';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/shared/ui/tabs';

export async function ProposalsDashboard() {
  const profile = await getCurrentProfile();
  if (!profile) return null;

  const supabase = await createClient();

  // ë°›ì€ ì œì•ˆ (Creator)
  const { data: receivedProposals } = await supabase
    .from('proposals')
    .select(`
      *,
      funder:profiles!funder_id(username, avatar_url, company),
      project:projects(title, thumbnail_url)
    `)
    .eq('creator_id', profile.id)
    .order('created_at', { ascending: false });

  // ë³´ë‚¸ ì œì•ˆ (Funder)
  const { data: sentProposals } = await supabase
    .from('proposals')
    .select(`
      *,
      creator:profiles!creator_id(username, avatar_url),
      project:projects(title, thumbnail_url)
    `)
    .eq('funder_id', profile.id)
    .order('created_at', { ascending: false });

  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="mb-8 text-3xl font-bold">ì œì•ˆ ê´€ë¦¬</h1>

      <Tabs defaultValue="received">
        <TabsList>
          <TabsTrigger value="received">
            ë°›ì€ ì œì•ˆ ({receivedProposals?.length || 0})
          </TabsTrigger>
          <TabsTrigger value="sent">
            ë³´ë‚¸ ì œì•ˆ ({sentProposals?.length || 0})
          </TabsTrigger>
        </TabsList>

        <TabsContent value="received">
          <ProposalList
            proposals={receivedProposals || []}
            type="received"
          />
        </TabsContent>

        <TabsContent value="sent">
          <ProposalList
            proposals={sentProposals || []}
            type="sent"
          />
        </TabsContent>
      </Tabs>
    </div>
  );
}
```

---

## Phase 6: í’ˆì§ˆ ë³´ì¦

### ëª©í‘œ
- í…ŒìŠ¤íŠ¸ êµ¬í˜„
- ì„±ëŠ¥ ìµœì í™”
- ë³´ì•ˆ ê°•í™”
- ì˜ˆìƒ ì†Œìš” ì‹œê°„: 3ì¼

### 6.1 í…ŒìŠ¤íŠ¸ ì„¤ì •

`jest.config.js`:
```javascript
const nextJest = require('next/jest');

const createJestConfig = nextJest({
  dir: './',
});

const customJestConfig = {
  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
  moduleNameMapper: {
    '^@/(.*)$': '<rootDir>/src/$1',
  },
  testEnvironment: 'jest-environment-jsdom',
  testMatch: [
    '**/__tests__/**/*.[jt]s?(x)',
    '**/?(*.)+(spec|test).[jt]s?(x)',
  ],
  collectCoverageFrom: [
    'src/**/*.{js,jsx,ts,tsx}',
    '!src/**/*.d.ts',
    '!src/**/index.ts',
  ],
  coverageThreshold: {
    global: {
      branches: 70,
      functions: 70,
      lines: 70,
      statements: 70,
    },
  },
};

module.exports = createJestConfig(customJestConfig);
```

### 6.2 RLS í…ŒìŠ¤íŠ¸

`supabase/tests/rls.test.sql`:
```sql
-- RLS í…ŒìŠ¤íŠ¸ (pgTap ì‚¬ìš©)
BEGIN;

SELECT plan(10);

-- í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„±
INSERT INTO auth.users (id, email) VALUES
  ('11111111-1111-1111-1111-111111111111', 'creator@test.com'),
  ('22222222-2222-2222-2222-222222222222', 'funder@test.com');

INSERT INTO public.profiles (id, username, role) VALUES
  ('11111111-1111-1111-1111-111111111111', 'creator1', 'CREATOR'),
  ('22222222-2222-2222-2222-222222222222', 'funder1', 'FUNDER');

-- Test: í”„ë¡œí•„ì€ ëˆ„êµ¬ë‚˜ ë³¼ ìˆ˜ ìˆë‹¤
SET LOCAL role TO anon;
SELECT ok(
  EXISTS(SELECT 1 FROM public.profiles WHERE id = '11111111-1111-1111-1111-111111111111'),
  'Anonymous users can view profiles'
);

-- Test: ì‚¬ìš©ìëŠ” ìì‹ ì˜ í”„ë¡œí•„ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤
SET LOCAL role TO authenticated;
SET LOCAL request.jwt.claims TO '{"sub": "11111111-1111-1111-1111-111111111111"}';

UPDATE public.profiles SET bio = 'Updated bio' WHERE id = '11111111-1111-1111-1111-111111111111';
SELECT ok(
  (SELECT bio FROM public.profiles WHERE id = '11111111-1111-1111-1111-111111111111') = 'Updated bio',
  'User can update their own profile'
);

-- Test: ë‹¤ë¥¸ ì‚¬ìš©ìì˜ í”„ë¡œí•„ì€ ìˆ˜ì •í•  ìˆ˜ ì—†ë‹¤
UPDATE public.profiles SET bio = 'Hacked' WHERE id = '22222222-2222-2222-2222-222222222222';
SELECT ok(
  (SELECT bio FROM public.profiles WHERE id = '22222222-2222-2222-2222-222222222222') IS NULL,
  'User cannot update other profiles'
);

-- ë” ë§ì€ í…ŒìŠ¤íŠ¸...

SELECT * FROM finish();
ROLLBACK;
```

### 6.3 ì„±ëŠ¥ ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸

```typescript
// src/shared/lib/performance.ts

export const performanceConfig = {
  // ì´ë¯¸ì§€ ìµœì í™”
  images: {
    formats: ['webp', 'avif'],
    deviceSizes: [640, 750, 828, 1080, 1200],
    imageSizes: [16, 32, 48, 64, 96],
  },

  // ì„±ëŠ¥ ì˜ˆì‚°
  budgets: {
    lcp: 2500, // 2.5ì´ˆ
    inp: 200,  // 200ms
    cls: 0.1,  // 0.1
    ttfb: 800, // 800ms
  },

  // ìºì‹± ì „ëµ
  caching: {
    static: 31536000,     // 1ë…„
    dynamic: 3600,        // 1ì‹œê°„
    revalidate: 60,       // 1ë¶„
  },
};
```

---

## Phase 7: ë°°í¬ ë° ìš´ì˜

### ëª©í‘œ
- í”„ë¡œë•ì…˜ ë°°í¬
- ëª¨ë‹ˆí„°ë§ ì„¤ì •
- ì˜ˆìƒ ì†Œìš” ì‹œê°„: 2ì¼

### 7.1 Vercel ë°°í¬ ì„¤ì •

`vercel.json`:
```json
{
  "framework": "nextjs",
  "buildCommand": "pnpm build",
  "installCommand": "pnpm install",
  "regions": ["icn1"],
  "env": {
    "NEXT_PUBLIC_SUPABASE_URL": "@supabase_url",
    "NEXT_PUBLIC_SUPABASE_ANON_KEY": "@supabase_anon_key",
    "SUPABASE_SERVICE_ROLE_KEY": "@supabase_service_role_key"
  },
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "s-maxage=60, stale-while-revalidate"
        }
      ]
    }
  ]
}
```

### 7.2 ëª¨ë‹ˆí„°ë§ ì„¤ì •

`src/shared/lib/monitoring.ts`:
```typescript
import * as Sentry from '@sentry/nextjs';

export function initMonitoring() {
  if (process.env.NODE_ENV === 'production') {
    Sentry.init({
      dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
      environment: process.env.NODE_ENV,
      tracesSampleRate: 0.1,
      beforeSend(event) {
        // PII í•„í„°ë§
        if (event.user) {
          delete event.user.email;
          delete event.user.ip_address;
        }
        return event;
      },
    });
  }
}

// ì»¤ìŠ¤í…€ ì—ëŸ¬ ë¦¬í¬íŒ…
export function reportError(error: Error, context?: Record<string, any>) {
  console.error('Application error:', error);

  if (process.env.NODE_ENV === 'production') {
    Sentry.captureException(error, {
      extra: context,
    });
  }
}
```

---

## ìœ„í—˜ ê´€ë¦¬

### ê¸°ìˆ ì  ìœ„í—˜
1. **ë¹„ë””ì˜¤ ìŠ¤í† ë¦¬ì§€ ë¹„ìš©**
   - ì™„í™”: ì—„ê²©í•œ ì—…ë¡œë“œ ì œí•œ
   - ëª¨ë‹ˆí„°ë§: ì¼ì¼ ì‚¬ìš©ëŸ‰ ì¶”ì 
   - ëŒ€ì‘: ì„ê³„ê°’ ë„ë‹¬ ì‹œ ì•Œë¦¼

2. **ìŠ¤ì¼€ì¼ë§ ì´ìŠˆ**
   - ì™„í™”: ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜
   - ëª¨ë‹ˆí„°ë§: ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì¶”ì 
   - ëŒ€ì‘: CDN ë° ìºì‹± ì „ëµ

3. **ë³´ì•ˆ ì·¨ì•½ì **
   - ì™„í™”: RLS ì •ì±… ì ìš©
   - ëª¨ë‹ˆí„°ë§: ë³´ì•ˆ ê°ì‚¬ ë¡œê·¸
   - ëŒ€ì‘: ì •ê¸° ë³´ì•ˆ ì ê²€

### ë¹„ì¦ˆë‹ˆìŠ¤ ìœ„í—˜
1. **ì‚¬ìš©ì íšë“**
   - ì „ëµ: ì»¤ë®¤ë‹ˆí‹° íŒŒíŠ¸ë„ˆì‹­
   - ì¸¡ì •: ê°€ì…/ì´íƒˆë¥  ì¶”ì 

2. **ì½˜í…ì¸  í’ˆì§ˆ**
   - ì „ëµ: íë ˆì´ì…˜ ì‹œìŠ¤í…œ
   - ì¸¡ì •: ì‚¬ìš©ì í”¼ë“œë°±

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸

### ê°œë°œ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ëª¨ë“  FSD ë ˆì´ì–´ êµ¬í˜„
- [ ] í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 70% ì´ìƒ
- [ ] ì„±ëŠ¥ ì˜ˆì‚° ì¶©ì¡±
- [ ] RLS ì •ì±… ê²€ì¦
- [ ] ì ‘ê·¼ì„± ê²€ì‚¬ í†µê³¼

### ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- [ ] í”„ë¡œë•ì…˜ DB ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] ë„ë©”ì¸ ì„¤ì •
- [ ] SSL ì¸ì¦ì„œ
- [ ] ëª¨ë‹ˆí„°ë§ ë„êµ¬ ì„¤ì •

### ì¶œì‹œ í›„ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘
- [ ] ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
- [ ] ì—ëŸ¬ ì¶”ì 
- [ ] ë³´ì•ˆ ê°ì‚¬
- [ ] ë°±ì—… ê²€ì¦

---

## ë¶€ë¡: ì°¸ê³  ìë£Œ

### ê³µì‹ ë¬¸ì„œ
- [Next.js Documentation](https://nextjs.org/docs)
- [Supabase Documentation](https://supabase.com/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [Feature-Sliced Design](https://feature-sliced.design)

### í”„ë¡œì íŠ¸ ê´€ë ¨ ë¬¸ì„œ
- `CLAUDE.md`: ê°œë°œ í‘œì¤€ ë° ê°€ì´ë“œë¼ì¸
- `Vlanet.md`: ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­
- ë³¸ ë¬¸ì„œ: ì‹¤í–‰ ê³„íš

---

**ë¬¸ì„œ ë²„ì „:** 1.0.0
**ìµœì¢… ìˆ˜ì •:** 2024ë…„ í˜„ì¬
**ë‹¤ìŒ ë¦¬ë·°:** MVP ì™„ë£Œ í›„
